<html>
    <meta content="PG13" property="og:title" />
    <meta property="og:url" content="http://veriparty.parseapp.com" />
  <head>
     <?php
         $cache_expire = 60*60*24*365;
         header("Pragma: public");
         header("Cache-Control: max-age=".$cache_expire);
         header('Expires: ' . gmdate('D, d M Y H:i:s', time()+$cache_expire) . ' GMT');
     ?>
      <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
      <script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
      <script>  Parse.initialize("VveomUP33i8fEQoMSW9WnTkphnqiSPavEIeTF6Rn", "U25IKmBdFY577LeGyF8LZhKMzGJfKIpY6OlSJP3P"); </script>
    <title>VeriParty</title>

  </head>
  <body>

 <h1>Welcome to VeriParty</h1>
 <p> <div id="firstmessage">Cloud Test...</div></p>


 <div id="searcharea">
     <input type="search" name="search" id="search" placeholder="" />
 </div>


 <div id="attendinglist"> </div>
  <div id="name"></div>
    <script>

        Parse.Cloud.run('hello', {}, {
        success: function(result) {
            var response = $('<h1/>',
                    {
                        text: result
                    });
            $('#firstmessage').html(response);
        },
        error: function(error) {
            alert('error on hello')
        }
        });
    </script>


  <div id="fb-root"></div>
  <script src="//connect.facebook.net/en_US/all.js"></script>
  <script src="//connect.facebook.net/en_US/all/debug.js"></script>
  <script>
      window.fbAsyncInit = function() {
          // init the FB JS SDK
          FB.init({
              appId      : '582135378500426',                        // App ID from the app dashboard
              channelUrl : 'http://veriparty.parseapp.com/', // Channel file for x-domain comms
              status     : true,                                 // Check Facebook Login status
              xfbml      : true,                                  // Look for social plugins on the page
              oauth     : true
          });


      };
      // Here we subscribe to the auth.authResponseChange JavaScript event. This event is fired
      // for any authentication related change, such as login, logout or session refresh. This means that
      // whenever someone who was previously logged out tries to log in again, the correct case below
      // will be handled.
      FB.Event.subscribe('auth.authResponseChange', function(response) {

          console.log(response);
          // Here we specify what we do with the response anytime this event occurs.
          if (response.status === 'connected') {
              // The response object is returned with a status field that lets the app know the current
              // login status of the person. In this case, we're handling the situation where they
              // have logged in to the app.
              FB.api('/me', function(myresponse) {
//
//                  var temp = $('<h1/>',
//                          {
//                              text: 'Your name is ' + response.name
//                          });
                  $('#name').html(myresponse.name);
              });

              FB.api('/1431638650383461/attending', function(myresponse) {
                  console.log(myresponse);
                  for (var i=0;i<myresponse.data.length;i++){
                          var temp = $('<p/>',
                          {
                              text: myresponse.data[i].name
                          });
                      $('#attendinglist').append(temp);
                  }

              });


//              FB.ui(
//                      {
//                          method: 'feed',
//                          name: 'Preping for the hackathon',
//                          caption: "YOU DON'T WANT TO KNOW",
//                          description: (
//                                  'A small JavaScript library that allows you to harness ' +
//                                          'the power of Facebook, bringing the user\'s identity, ' +
//                                          'social graph and distribution power to your site.'
//                                  ),
//                          link: 'http://veriparty.parseapp.com/',
////                          picture: 'http://www.fbrell.com/public/f8.jpg'
//                          picture: 'http://veriparty.parseapp.com/icon.jpg'
//                      },
//                      function(response) {
//                          if (response && response.post_id) {
////                                  alert('Post was published.');
//                          } else {
////                                  alert('Post was not published.');
//                          }
//                      }
//              );
          } else if (response.status === 'not_authorized') {
              alert('not authorized');
              FB.login();
          } else {
              alert('you need to log on facebook');
              FB.login();
          }
      });
      // Additional initialization code such as adding Event Listeners goes here
      // Load the SDK asynchronously
      (function(){
          // If we've already installed the SDK, we're done
          if (document.getElementById('facebook-jssdk')) {return;}

          // Get the first script element, which we'll use to find the parent node
          var firstScriptElement = document.getElementsByTagName('script')[0];

          // Create a new script element and set its id
          var facebookJS = document.createElement('script');
          facebookJS.id = 'facebook-jssdk';

          // Set the new script's source to the source of the Facebook JS SDK
          facebookJS.src = '//connect.facebook.net/en_US/all.js';

          // Insert the Facebook JS SDK into the DOM
          firstScriptElement.parentNode.insertBefore(facebookJS, firstScriptElement);
      }());
  </script>
  </body>
</html>
